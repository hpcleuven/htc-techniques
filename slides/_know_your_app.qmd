# Know Your App


## Step 1. Representative Case

- Define a representative case
  (keep domain size, particles, protein size, genome size)
- Runtime of +/- minutes
  (reduced timesteps)


## Resource considerations

- Serial vs parallel code
  if parallel, MPI? OpenMP? or hybrid?
- CPU or GPU needed
- max memory needed
- I/O pattern and storage request


## Example: DGEMM

- `R` script for matrix-matrix multiplication
- Using BLAS with OpenMP multi-threading
  (Avoid oversubscription by setting `OMP_NUM_THREADS`)
- Using parallel `foreach` for multiple matrices

```{bash}
module load R/4.4.1-gfbf-2024a

# call signature
export OMP_NUM_THREADS=1
dgemm.R --nr-matrices <M> --matrix-size <S> \
        --power <P> --seed <Z> --nr-cores <C>
```

- experiment with input variables `M, S, P, C`


## 1.x. Varying `--nr-cores`

`OMP_NUM_THREADS=1`

## 1.y. Varying `--matrix-size` & `--power`

`OMP_NUM_THREADS=1`

## 1.z. Varying `OMP_NUM_THREADS`

`S = ..., P = ..., C = ...`

## Optimal Setup

`OMP_NUM_THREADS=1`
`S`
`P`
`C`
